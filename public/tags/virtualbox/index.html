<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="/css/github-markdown.css" type="text/css" media="all">
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="all">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://girigiribauer.com/index.xml">
    <title>VirtualBox - ばうあーろぐ</title>
    <meta property="og:title" content="VirtualBox - ばうあーろぐ">
    <meta property="og:type" content="article">
    <meta name="description" content="Webテクノロジーに関するメモ、あるいはTwentyFour">
    <meta property="og:description" content="Webテクノロジーに関するメモ、あるいはTwentyFour">
    <meta property="og:url" content="http://girigiribauer.com/tags/virtualbox/">
    <meta property="fb:app_id" content="396423247105258">
    <meta property="og:image" content="http://girigiribauer.com/img/ogimage.png">
<meta name="generator" content="Hugo 0.17" />
  </head>
  <body>

<div class="markdown-body">
<header>
<a href="/">ばうあーろぐ TOP へ戻る</a>
</header>


<div class="maincontents">

<h1>Tags / VirtualBox</h1>

<div class="poststatus">
  <p>  <time datetime="2013年5月10日">2013年5月10日</time>
</p>

  <ul class="tags">
    <li class="flow"><a href="/tags/chef/">Chef</a></li>
    <li class="flow"><a href="/tags/vagrant/">Vagrant</a></li>
    <li class="flow"><a href="/tags/virtualbox/">VirtualBox</a></li>
    <li class="flow"><a href="/tags/virtualization/">virtualization</a></li>
  </ul>
</div>




<p><a href="/archives/966/">前々回</a>、<a href="/archives/1003/">前回</a>までで、ようやく気軽に作って壊せる仮想環境が用意できたので、 ここからは実際に仮想環境に作っていくところをやりたいと思います。</p>

<p><strong>※まだあやふやな部分が多いので、明らかに違っていた箇所はあとで修正する可能性があります。</strong></p>

<p>もちろんゴールは、実際に少し作れるところまでです。（ファイルを自動で配置するとか、アプリケーションインストール済みの状態にするとか）</p>

<p>ただ、そこまで大規模なものは想定していないので（数百台を一元管理とかは絶対やらない）、ローカル環境だけで気軽に試せる方法をとっていきます。</p>

<p>以下、こんな感じで最小構成で進めていきます。</p>

<ol>
<li>Vagrant を最低限使えるようにする（終わってます）</li>
<li>Chef を最低限使えるようにする</li>
<li>簡単な Cookbook を用意する</li>
<li>Vagrant, Chef を連携させて、仮想環境が変化するか見てみる</li>
</ol>

<h2 id="chef-とは">Chef とは？</h2>

<p>最近かなり頻繁に聞くワードです。</p>

<p>サーバ構築、システム管理の自動化を助けてくれるツールです。アプリケーションのインストールや、OS・ミドルウェアの設定などを、Cookbook と呼ばれる設定ファイルに落とし込んでおくと、各プラットフォームの差異を吸収したうえで、その設定ファイルの状態に保ってくれます。</p>

<p>詳しくはまだまだこれからです。ただ気軽に試せる環境を用意したので、ここからどんどんと試してみようと思います。</p>

<p>また、自動化というメリットの他にも、こういう気軽に試して壊してが出来るってところは大きなメリットだなーと思います。 では早速。</p>

<h2 id="chef-をインストール">Chef をインストール</h2>

<p>まず Chef に関連したパッケージを gem でインストールしてみます。gem ならば比較的すぐです。</p>

<pre><code>$ gem install chef
Fetching: chef-11.4.4.gem (100%)
Successfully installed chef-11.4.4
1 gem installed
$ chef-solo -v
Chef: 11.4.4
</code></pre>

<p>chefというパッケージを入れると、<strong>chef-solo, chef-client, knife</strong> などのコマンドが一式用意されるようです。試しに chef-solo -v と打ってみたら、「Chef のバージョンは11.4.4ですよー」と表示されました。</p>

<p>ちなみに、数百、数千台とか管理するわけでもないので、Chef Server を用意してうんぬん・・・というのは今回やらずに、 サーバの役割を内包しつつ単独で動く、<strong>Chef Solo</strong> を使っていきます。</p>

<p>さてさて、何か Cookbook を作ってみることにします。</p>

<h2 id="cookbook-を作る">Cookbook を作る！</h2>

<p>※以下、2012年10月に発売された『Software Design / Chef 入門』を参考に進めます。</p>

<p>Cookbook 自体は、<strong>ただのディレクトリとテキストファイル群</strong>にすぎないので、 実際 Chef のコマンド一式なくても作れます。 （knife というひな形を作ってくれるコマンドがあるものの、後回しにしようと思います。）</p>

<p>また、設定ファイルも最近よくある、設定ファイルっぽく書いていたら実はそれが Ruby のスクリプトだった（DSL）という類のものなので、 これもエディタさえあれば用意できてしまいます。</p>

<p>実際に Chef が担当するのは、その Cookbook に書かれた設定項目に沿って、アプリケーションなり設定値なりを反映するところになるので、 そのあたりを理解するためにも、最初は手書きで用意してみようと思います。</p>

<h3 id="vagrantfile-を若干見直し">Vagrantfile を若干見直し</h3>

<p>Cookbook を用意する前に、1つだけ Vagrantfile の見直しをしたいと思います。 というのも、今後こちらに Cookbook の置き場所の指定などをするためです。</p>

<pre><code>Vagrant.configure(&quot;2&quot;) do |config|
  config.vm.box = &quot;CentOS_6.4_x86_64_Minimal&quot;

  config.vm.define :vmclient1 do |vmclient|
    vmclient.vm.hostname = &quot;vmclient1&quot;
    vmclient.vm.network :private_network, ip: &quot;192.168.100.11&quot;
  end

  config.vm.define :vmclient2 do |vmclient|
    vmclient.vm.hostname = &quot;vmclient2&quot;
    vmclient.vm.network :private_network, ip: &quot;192.168.100.12&quot;
  end
end
</code></pre>

<p>こんな感じで、<code>config.vm.define</code> で仮想マシンを複数立ち上げることが可能です。 先にも書いたようにこれ実際は Ruby のコードなので、ループとかで回すこともできますね。 （とはいえ、ゲストOS立ち上げまくったらホストOSが重くなるのは必然ですし、それぞれの起動時間もそれなりにかかります。）</p>

<p>ゆくゆくは仮想マシン間のネットワークの検証なども行っていきたいので、最小構成は2台としておきたいなーと思います。</p>

<p>それぞれを、vmclient1, vmclient2 として管理していき、 vmclient1 の方は<strong>簡単なテキストファイルの設置</strong> (/tmp/test.txt) を、 vmclient2 の方は<strong>簡単なアプリケーションの設置</strong> (Webサーバ, Apache) を行ってみようと思います。</p>

<h3 id="レシピを用意する">レシピを用意する</h3>

<p>前回までで、Vagrant 用のディレクトリを作っていたので、その中で Cookbook 用のディレクトリを用意します。</p>

<pre><code>$ cd ~/Vagrant
$ mkdir cookbooks
</code></pre>

<p>vmclient1, vmclient2 用のレシピを用意します。まず vmclient1 から。</p>

<pre><code>cat cookbooks/vmclient1/recipes/default.rb
# Cookbook ファイル設置テスト

file &quot;/tmp/test.txt&quot; do
  content &quot;vmclient1 にダミーテキストファイルを作りました！&quot;
end
</code></pre>

<p>こちらは、content に書かれた内容のファイルを、仮想マシンの /tmp/test.txt へと作成するレシピです。</p>

<p>続けて vmclient2 の方です。</p>

<pre><code>cat cookbooks/vmclient2/recipes/default.rb
# Cookbook アプリケーション設置テスト

package &quot;httpd&quot; do
  action :install
end
</code></pre>

<p>こちらは、httpd（つまりApache）をインストールするというレシピになります。</p>

<p>※まだこのあたりが完全に分かってないのですが、CentOS では httpd で良さげでも、他ディストリビューションなどでは apache2 というパッケージ名にしたりする必要があるらしく、この辺のパッケージ名は吸収してくれないのかなーとか、ちょっと疑問でした。</p>

<h2 id="vagrant-chef-の連携">Vagrant, Chef の連携</h2>

<p>Vagrantfile の中には、<strong>chef-solo</strong> の設定項目も存在します。</p>

<p><a href="http://docs.vagrantup.com/v2/provisioning/chef_solo.html" target="_blank">http://docs.vagrantup.com/v2/provisioning/chef_solo.html</a></p>

<p>これを使って、Vagrant 経由で起動した仮想マシンに対して、レシピを適用してみます。</p>

<h3 id="再度-vagrantfile-を見直し">再度 Vagrantfile を見直し</h3>

<pre><code>Vagrant.configure(&quot;2&quot;) do |config|
  config.vm.box = &quot;CentOS_6.4_x86_64_Minimal&quot;

  config.vm.define :vmclient1 do |vmclient|
    vmclient.vm.hostname = &quot;vmclient1&quot;
    vmclient.vm.network :private_network, ip: &quot;192.168.100.11&quot;

    vmclient.vm.provision :chef_solo do |chef|
      chef.cookbooks_path = &quot;cookbooks&quot;
      chef.run_list = &quot;recipe[vmclient1]&quot;
    end
  end

  config.vm.define :vmclient2 do |vmclient|
    vmclient.vm.hostname = &quot;vmclient2&quot;
    vmclient.vm.network :private_network, ip: &quot;192.168.100.12&quot;

    vmclient.vm.provision :chef_solo do |chef|
      chef.cookbooks_path = &quot;cookbooks&quot;
      chef.run_list = &quot;recipe[vmclient2]&quot;
    end
  end
end
</code></pre>

<p>やってることは簡単で、今回用意した2つの仮想マシンそれぞれに対して、chef-solo の設定項目を設け、 Cookbook のパスとレシピ名を指定しているだけです。</p>

<p>とりあえずここまでやったら、一旦仮想マシンを壊して初期状態に戻しておきます。</p>

<pre><code>$ vagrant destroy
Are you sure you want to destroy the 'vmclient2' VM? [y/N] y
[vmclient2] Forcing shutdown of VM...
[vmclient2] Destroying VM and associated drives...
Are you sure you want to destroy the 'vmclient1' VM? [y/N] y
[vmclient1] Forcing shutdown of VM...
[vmclient1] Destroying VM and associated drives...
</code></pre>

<h3 id="レシピの適用">レシピの適用！</h3>

<p>さて、いよいよレシピを適用してみます。<strong>vagrant up!! vagrant up!!</strong></p>

<pre><code>$ vagrant up
</code></pre>

<p>すると、ずらずらーっとログが出力されます。</p>

<pre><code>Bringing machine 'vmclient1' up with 'virtualbox' provider...
Bringing machine 'vmclient2' up with 'virtualbox' provider...
[vmclient1] Importing base box 'CentOS_6.4_x86_64_Minimal'...

[vmclient1] Matching MAC address for NAT networking...
[vmclient1] Setting the name of the VM...
[vmclient1] Clearing any previously set forwarded ports...
[vmclient1] Fixed port collision for 22 =&gt; 2222. Now on port 2202.
[vmclient1] Creating shared folders metadata...
[vmclient1] Clearing any previously set network interfaces...
[vmclient1] Preparing network interfaces based on configuration...
[vmclient1] Forwarding ports...
[vmclient1] -- 22 =&gt; 2202 (adapter 1)
[vmclient1] Booting VM...
[vmclient1] Waiting for VM to boot. This can take a few minutes.
[vmclient1] VM booted and ready for use!
[vmclient1] Setting hostname...
[vmclient1] Configuring and enabling network interfaces...
[vmclient1] Mounting shared folders...
[vmclient1] -- /vagrant
</code></pre>

<p>2つの仮想マシンを立ち上げているので、それぞれログにも名前がついてます。 ただ基本的に1台のときとやっていることは同じで、 ネットワークの設定やら共有ディレクトリの設定やらをやってくれてます。</p>

<p>ここまでは同じですね！　さらに出力は続きます。</p>

<pre><code>[vmclient1] -- /tmp/vagrant-chef-1/chef-solo-1/cookbooks
[vmclient1] Running provisioner: chef_solo...
Generating chef JSON and uploading...
Running chef-solo...
</code></pre>

<p>おっと、ここから chef-solo が起動してることが確認できました。</p>

<pre><code>[2013-05-09T22:14:33+00:00] INFO: *** Chef 11.4.0 ***
[2013-05-09T22:14:33+00:00] INFO: Setting the run_list to &quot;recipe[vmclient1]&quot; from JSON
[2013-05-09T22:14:33+00:00] INFO: Run List is [recipe[vmclient1]]
[2013-05-09T22:14:33+00:00] INFO: Run List expands to [vmclient1]
[2013-05-09T22:14:33+00:00] INFO: Starting Chef Run for vmclient1
[2013-05-09T22:14:33+00:00] INFO: Running start handlers
[2013-05-09T22:14:33+00:00] INFO: Start handlers complete.
[2013-05-09T22:14:33+00:00] INFO: Processing file[/tmp/test.txt] action create (vmclient1::default line 3)
[2013-05-09T22:14:33+00:00] INFO: entered create
[2013-05-09T22:14:33+00:00] INFO: file[/tmp/test.txt] created file /tmp/test.txt
[2013-05-09T22:14:33+00:00] INFO: Chef Run complete in 0.060882068 seconds
[2013-05-09T22:14:33+00:00] INFO: Running report handlers
[2013-05-09T22:14:33+00:00] INFO: Report handlers complete
</code></pre>

<p>・・・vmclient1 のログはここまでのようですね。</p>

<p>Vagrantfile に指定されたレシピが、 chef-solo を介して実行され、実際にファイルの設置が行われていたようです。</p>

<p>確認は後回しにして、さらに vmclient2 のログも見てみます。</p>

<pre><code>[vmclient2] Importing base box 'CentOS_6.4_x86_64_Minimal'...

[vmclient2] Matching MAC address for NAT networking...
[vmclient2] Setting the name of the VM...
[vmclient2] Clearing any previously set forwarded ports...
[vmclient2] Fixed port collision for 22 =&gt; 2202. Now on port 2203.
[vmclient2] Creating shared folders metadata...
[vmclient2] Clearing any previously set network interfaces...
[vmclient2] Preparing network interfaces based on configuration...
[vmclient2] Forwarding ports...
[vmclient2] -- 22 =&gt; 2203 (adapter 1)
[vmclient2] Booting VM...
[vmclient2] Waiting for VM to boot. This can take a few minutes.
[vmclient2] VM booted and ready for use!
[vmclient2] Setting hostname...
[vmclient2] Configuring and enabling network interfaces...
[vmclient2] Mounting shared folders...
[vmclient2] -- /vagrant
</code></pre>

<p>vmclient2 も、ここまでは今までと同様です。</p>

<pre><code>[vmclient2] -- /tmp/vagrant-chef-1/chef-solo-1/cookbooks
[vmclient2] Running provisioner: chef_solo...
Generating chef JSON and uploading...
Running chef-solo...
[2013-05-09T22:15:42+00:00] INFO: *** Chef 11.4.0 ***
[2013-05-09T22:15:42+00:00] INFO: Setting the run_list to &quot;recipe[vmclient2]&quot; from JSON
[2013-05-09T22:15:42+00:00] INFO: Run List is [recipe[vmclient2]]
[2013-05-09T22:15:42+00:00] INFO: Run List expands to [vmclient2]
[2013-05-09T22:15:42+00:00] INFO: Starting Chef Run for vmclient2
[2013-05-09T22:15:42+00:00] INFO: Running start handlers
[2013-05-09T22:15:42+00:00] INFO: Start handlers complete.
[2013-05-09T22:15:42+00:00] INFO: Processing package[httpd] action install (vmclient2::default line 3)
[2013-05-09T22:15:59+00:00] INFO: package[httpd] installing httpd-2.2.15-26.el6.centos from base repository
[2013-05-09T22:16:06+00:00] INFO: Chef Run complete in 23.898427112 seconds
[2013-05-09T22:16:06+00:00] INFO: Running report handlers
[2013-05-09T22:16:06+00:00] INFO: Report handlers complete
</code></pre>

<p>こちらのログは、httpd 関連のログになってますね。ログを見る限りではインストールは正しく行われたようです。</p>

<h3 id="正しくレシピが反映されたか確認してみる">正しくレシピが反映されたか確認してみる</h3>

<p>まず vmclient1 の方へログインしてみます。</p>

<pre><code>$ vagrant ssh vmclient1
Welcome to your Vagrant-built virtual machine.
</code></pre>

<p>さて、ファイルは存在しているでしょうか？</p>

<pre><code>[vagrant@vmclient1 ~]$ cat /tmp/test.txt
vmclient1 にダミーテキストファイルを作りました！[vagrant@vmclient1 ~]$
</code></pre>

<p>あ・・・最後に改行が入ってなかったのでちょっとアレですが、 でも<strong>ファイルはちゃんと出来てました！</strong></p>

<p>ついでに、こちらに httpd がインストールされていないことを確認しておきます。</p>

<pre><code>$ which httpd
/usr/bin/which: no httpd in (/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/vagrant/bin)
</code></pre>

<p>入ってませんでした。</p>

<p>続けて、vmclient2 の方へログインしてみます。</p>

<pre><code>$ vagrant ssh vmclient2
Welcome to your Vagrant-built virtual machine.

[vagrant@vmclient2 ~]$ which httpd
/usr/sbin/httpd
</code></pre>

<p><strong>おおー、入ってますね。</strong></p>

<p>こちらもついでに、上記パスにテキストファイルが置かれていないことを確認しておきます。</p>

<pre><code>[vagrant@vmclient2 ~]$ cat /tmp/test.txt
cat: /tmp/test.txt: そのようなファイルやディレクトリはありません
</code></pre>

<p>無かったですね。レシピがきちんと環境ごとに分かれて適用されてました。すげー。</p>

<h2 id="まとめ">まとめ</h2>

<p>Cookbook をローカルで気軽に試してレシピが書ける環境があれば、 <strong>物理マシンや VPS 上などでの作業が格段に減り、かなりの効率化が図れるなーという印象です。</strong></p>

<p>個人的には、何よりも作って試して、時には壊して、という<strong>気持ち的な敷居が低いところがとてもいいなー</strong>と思います。 かなり楽しんでやれちゃいそうです。</p>

<p>ここから先は、Cookbook の書き方を種類ごとに覚えつつも、 自分で作った Cookbook を実践配備するところも併せてやっていけたらなーと思います！</p>

<h2 id="ref">参考URL</h2>

<ul>
<li><a href="http://docs.vagrantup.com/v2/" target="_blank">Vagrant Documentation</a></li>
<li><a href="http://blog.madoro.org/mn/81" target="_blank">Chefを最速で使いこなすためのいくつかのポイント &#8211; Masatomo Nakano Blog</a></li>
</ul>


<ul class="socialbuttons">
  <li class="flow">
    <a href="https://twitter.com/share" class="twitter-share-button" data-lang="ja" data-count="vertical">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </li>
  <li class="flow">
    <div class="fb-like" data-layout="button" data-action="like" data-size="small" data-show-faces="false" data-share="false"></div>
  </li>
  <li class="flow">
    <a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="en" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
</ul>

<div class="poststatus">
  <p>  <time datetime="2013年5月10日">2013年5月10日</time>
</p>

  <ul class="tags">
    <li class="flow"><a href="/tags/chef/">Chef</a></li>
    <li class="flow"><a href="/tags/vagrant/">Vagrant</a></li>
    <li class="flow"><a href="/tags/virtualbox/">VirtualBox</a></li>
    <li class="flow"><a href="/tags/virtualization/">virtualization</a></li>
  </ul>
</div>

<small>もし記事内に誤りなどございましたら、 <a href="https://twitter.com/girigiribauer" target="_blank">@girigiribauer</a> までご一報いただけると助かります。</small>

<div class="poststatus">
  <p>  <time datetime="2013年5月7日">2013年5月7日</time>
</p>

  <ul class="tags">
    <li class="flow"><a href="/tags/vagrant/">Vagrant</a></li>
    <li class="flow"><a href="/tags/virtualbox/">VirtualBox</a></li>
    <li class="flow"><a href="/tags/virtualization/">virtualization</a></li>
  </ul>
</div>




<p>個々の仮想マシンのアプリケーションを入れていく前に、仮想マシンの操作でよくある<strong>『スナップショット機能』</strong>的なものが使えるように、 Vagrant のプラグインの追加をしたいと思います。</p>

<h2 id="sahara-プラグインのインストール">sahara プラグインのインストール</h2>

<p>Vagrant 1.0 までは vagrant に続けて gem サブコマンドで入れられたようですが、 Vagrant 1.1 以降は、<code>plugin</code> サブコマンドを使うようです。</p>

<p>と思って試したら、どうやら Vagrant1.1 以降では対応してないようで・・・。</p>

<p>で色々と調べていたら、対応させている方が！素敵ですねー。</p>

<p><a href="http://www.ryuzee.com/contents/blog/6555" target="_blank">Vagrantの必須プラグインSaharaをVagrant 1.1に対応させました | Ryuzee.com</a></p>

<p>こちらの方の記事にもあるように、『Vagrantを使っている人であれば必携のプラグイン』とあるので、 これはぜひとも入れておき、砂場のように作りは消し、作りは消しが簡単に出来るようにしておきたいですね！ （必携といわれるくらいなので、ひょっとしたら後で記事見直したら、この辺きちんと整備されているかもしれませんね。）</p>

<pre><code>$ git clone https://github.com/ryuzee/sahara.git
（略）
$ cd sahara
$ bundle install
Fetching gem metadata from http://rubygems.org/..........
Fetching gem metadata from http://rubygems.org/..
Resolving dependencies...
Using rake (0.9.2.2)
Installing Platform (0.4.0)
Using bundler (1.3.5)
Installing open4 (1.3.0)
Installing popen4 (0.1.2)
Installing thor (0.18.1)
Using sahara (0.0.14) from source at .
Your bundle is complete!
Use `bundle show [gemname]` to see where a bundled gem is installed.
$ bundle exec rake build
sahara 0.0.14 built to pkg/sahara-0.0.14.gem.
</code></pre>

<p>bundle 使ってビルドすると、 sahara/pkg/ 以下に gem ファイルが出来ました。これを以下の代わりに</p>

<pre><code>$ vagrant plugin install sahara
</code></pre>

<p>gem ファイルを指定してやってインストールする、と。</p>

<pre><code>$ vagrant plugin install pkg/sahara-0.0.14.gem
Installing the 'pkg/sahara-0.0.14.gem' plugin. This can take a few minutes...
Installed the plugin 'sahara (0.0.14)'!
</code></pre>

<p>これで入りました。 （この辺整備されたら、git clone でリポジトリ持ってくるところから <code>vagrant plugin install sahara</code> の手前までは不要ですね。）</p>

<p>入ったことを確認するために、<code>list</code> サブコマンドを使ってみます。</p>

<pre><code>$ vagrant plugin list
sahara (0.0.14)
</code></pre>

<p>これで入りました。</p>

<h2 id="sahara-プラグインを使ってみる">sahara プラグインを使ってみる</h2>

<p>インストールの仕方がちょっと違っただけで、使い方は同じなので、配布先見てみます。</p>

<p><a href="https://github.com/jedi4ever/sahara" target="_blank">https://github.com/jedi4ever/sahara</a></p>

<p>こちらによると、以下のコマンドが用意されているようです。</p>

<pre><code>vagrant sandbox on
vagrant sandbox commit
vagrant sandbox rollback
vagrant sandbox off
</code></pre>

<p>サンドボックスモードをオンにしたあと、commit か rollback でその作業をしたことにするか、あるいはしてなかったことにするかを決められるようです。データベースと同じですね。</p>

<p>では、一番シンプルで分かりやすいであろう、仮想マシンのホームディレクトリに &#8216;hello&#8217; という空ファイルを作り、 rollback して元に戻っているかどうかを検証したいと思います。</p>

<pre><code>$ vagrant sandbox on
0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%
</code></pre>

<p>お、なんですかねこの数字。きっとスナップショットを取るのにある程度時間がかかるのでしょう。（といっても数秒でしたが）</p>

<pre><code>$ vagrant ssh
Last login: Sat May  4 23:10:49 2013 from [your-ip-address]
Welcome to your Vagrant-built virtual machine.
[vagrant@localhost ~]$ touch hello
[vagrant@localhost ~]$ ls
hello
</code></pre>

<p>はい、さくっとホームディレクトリに空の &#8216;hello&#8217; というファイルを作りました。</p>

<p>そして、世界を戻してみます。</p>

<pre><code>$ logout
Connection to 127.0.0.1 closed.
$ vagrant sandbox rollback
0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%
0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%
</code></pre>

<p>おお、なんかスナップショット周りに変化があったようですね。</p>

<p>もう一度さっきのファイルを確認するために、ssh で接続してみます。</p>

<pre><code>vagrant ssh
Last login: Sat May  4 23:10:49 2013 from [your-ip-address]
Welcome to your Vagrant-built virtual machine.
[vagrant@localhost ~]$ ls
[vagrant@localhost ~]$
</code></pre>

<p>おおー！なくなってたー！</p>

<h2 id="まとめ">まとめ</h2>

<p>sahara プラグインのような、スナップショットをコントロールできる機能は、やはり有ると無いのとでは全然違いますね。</p>

<p>ここから先の検証は、上手くいくかどうか怪しいところでスナップショットを取っておいて、 ごにょごにょやったあとで上手く行ったら commit で決定、失敗したら rollback で破棄すれば、 <strong>検証がしやすくなること間違いなしです！</strong></p>


<ul class="socialbuttons">
  <li class="flow">
    <a href="https://twitter.com/share" class="twitter-share-button" data-lang="ja" data-count="vertical">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </li>
  <li class="flow">
    <div class="fb-like" data-layout="button" data-action="like" data-size="small" data-show-faces="false" data-share="false"></div>
  </li>
  <li class="flow">
    <a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="en" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
</ul>

<div class="poststatus">
  <p>  <time datetime="2013年5月7日">2013年5月7日</time>
</p>

  <ul class="tags">
    <li class="flow"><a href="/tags/vagrant/">Vagrant</a></li>
    <li class="flow"><a href="/tags/virtualbox/">VirtualBox</a></li>
    <li class="flow"><a href="/tags/virtualization/">virtualization</a></li>
  </ul>
</div>

<small>もし記事内に誤りなどございましたら、 <a href="https://twitter.com/girigiribauer" target="_blank">@girigiribauer</a> までご一報いただけると助かります。</small>

<div class="poststatus">
  <p>  <time datetime="2013年5月5日">2013年5月5日</time>
</p>

  <ul class="tags">
    <li class="flow"><a href="/tags/vagrant/">Vagrant</a></li>
    <li class="flow"><a href="/tags/virtualbox/">VirtualBox</a></li>
    <li class="flow"><a href="/tags/virtualization/">virtualization</a></li>
  </ul>
</div>




<p>もう最近では、OSの上にOSを動かす仮想環境が当たり前になってきていますが、そのソフトウェアの1つに <strong>VirtualBox</strong> というものがあります。</p>

<p><strong>Vagrant</strong> は、元々この VirtualBox を CUI（コマンドライン）でいじれるツールだったのですが、 バージョン1.1以降で VirtualBox 以外のソフトウェアにも対応してくれるようになったため、 今では VirtualBox に限らず使えます。</p>

<p>ちなみに個人としては、Windows に関しては描画の再現性なども考慮して、Mac 上で <strong>VMWare Fusion</strong> （有料）を起動して、その上に Windows7 やら Windows8 やらをインストールして検証用に使っています。（それでもさくさく動く Retina MacBook Pro 最高ですね！）</p>

<p>一方で、サーバ用途に用いられるような、描画の再現性を考えなくてもよいOSについての検証は、VirtualBox を起動して、その上に CentOS などを入れて今後検証していこうかなと考えています。（まだまだこれからです）</p>

<p>このような、後者のサーバ用途に用いるOSの検証で、いちいち VirtualBox（や他のソフトウェア） を GUI から立ち上げて、GUI でぽちぽちとインストールを行って、起動させるような作業を毎回繰り返す場合、Vagrant はかなり役に立ってくれるのではないかと思います。</p>

<p>まずは Vagrant の準備の仕方や考え方などを軽くまとめてみました。</p>

<h2 id="virtualbox-vagrant-のインストール">VirtualBox, Vagrant のインストール</h2>

<p>まず、事前に VirtualBox を入れておきます。（Vagrant 1.1 からは必ずしも VirtualBox ではなくてもいいのですが、前述の通り今回はサーバ用途で VirtualBox を使うという前提での準備なので、VirtualBox でやります）</p>

<p>Vagrant の 1.0 も入れたことがあるのですが、こちらは <code>gem install vagrant</code> で一発インストールだったのに比べ、1.1以降は専用のパッケージをインストールします。（ちなみに記事書いてる時点の最新は、1.2.2 のようです）</p>

<p><img src="/img/2013/05/vagrant01.png" alt="" /></p>

<p>なんか開発速度がめちゃ早いので、あとでこの記事見返したらバージョン古くなってることでしょう。</p>

<p><img src="/img/2013/05/vagrant02.png" alt="" /></p>

<p>あとは普通にインストールをしていきます。</p>

<p><img src="/img/2013/05/vagrant03.png" alt="" /></p>

<p>はい、インストール完了しました。</p>

<pre><code>$ which vagrant
/usr/bin/vagrant
</code></pre>

<p>この時点で、vagrant というコマンドが用意されていると思うので、 ここから先は vagrant コマンドとそれに続くサブコマンドで、仮想環境を作って行きます。</p>

<p>ちなみに help は、<code>vagrant -h</code> で出ます。</p>

<pre><code>$ vagrant -h
Usage: vagrant [-v] [-h] command [&lt;args&gt;]

    -v, --version                    Print the version and exit.
    -h, --help                       Print this help.

Available subcommands:
     box
     destroy
     halt
     init
     package
     plugin
     provision
     reload
     resume
     ssh
     ssh-config
     status
     suspend
     up

For help on any individual command run `vagrant COMMAND -h`
</code></pre>

<h2 id="vagrant-でよく使う名前とかコマンドとか">Vagrant でよく使う名前とかコマンドとか</h2>

<p>僕もそんなに物理PCのセットアップを数多くやってきているわけではないのですが、 ここから先は物理PCのセットアップの、どの作業に対応しているかを考えながらやった方が イメージがしやすいのではないかと思います。</p>

<ol>
<li>ボックスを用意する（物理PCにおけるインストールディスクを用意する、に近い）</li>
<li>仮想マシンのインストール（物理PCにおける物理マシンのインストール、に近い）</li>
<li>インストール後の設定など</li>
</ol>

<p>こんな感じの流れで進めていきます。</p>

<h2 id="ボックスを用意する">ボックスを用意する</h2>

<p>まずはボックスを追加してやる必要があります。このボックスから仮想マシンを作るため、<strong>例えるならインストールディスクを用意する工程に相当</strong>するのかもしれません。</p>

<p>ボックスを追加するコマンドは <code>vagrant box add</code> なので、とりあえず help でもみてみます。</p>

<pre><code>vagrant box add -h
Usage: vagrant box add &lt;name&gt; &lt;url&gt; [--provider provider] [-h]

    -f, --force                      Overwrite an existing box if it exists.
        --insecure                   If set, SSL certs will not be validated.
        --provider provider          The provider that backs the box.
    -h, --help                       Print this help
</code></pre>

<p>この name というのは、例えるならインストールディスクに名前をつける行為に相当するので、 例えば CensOS のバージョン何々で・・・みたいな名前になるわけで、（あるいはOSやバージョンに紐づいた用途別の名前など）決して<strong>仮想マシンのPC名になるわけではありません。</strong> （僕はここで勘違いをして、変な名前をつけて混乱してました。）</p>

<p>また、url はボックスファイルが公開されている場所に相当します。ボックスファイルは、各OS、ディストリビューション、初期で入ってるアプリケーションごとに色々以下に用意されています。ありがたいですね。</p>

<p><a href="http://www.vagrantbox.es/" target="_blank">http://www.vagrantbox.es/</a></p>

<p>そもそもこのボックスファイルというのは何なのか、というところなのですが、実はこれ自分で作れます。</p>

<p><a href="http://tk0miya.hatenablog.com/entry/2013/03/15/115710" target="_blank">vagrant ユーザよ、その VM は安全なのか? (veewee のすゝめ) &#8211; Hack like a rolling stone</a></p>

<p>確かにやろうと思えば、不正なプログラムをこっそり入れたボックスファイルを公開して、ってのも全然出来なくない話なので、 相当な信頼性を求められるようなものであれば、こういった自分で作る方法も検討すべきなのですが、 今回はそうではないので vagrantbox.es を利用させていただきます。</p>

<p>また、自分で作る方法を見ればなんとなく予想がつくように、ボックスファイルは配布されている ISO ディスクイメージに 設定ファイルを合わせたようなものにすぎないため、ほぼ公開されているディスクイメージに近いものだと考えてもよさそうです。</p>

<h3 id="どれを選べばいいの">どれを選べばいいの？</h3>

<p>この辺は、知らないキーワードがあれば1つずつぐぐりながら調べていくしかないのですが、 今回はサーバ用途の検証に使うので、よくある VPS（Virtual Private Server）構成に近いものを選びます。</p>

<ul>
<li>CentOS の現時点での最新であるバージョン 6.4</li>
<li>64ビット (i386 が32ビット, x86_64 が64ビットで、最近はほぼ全て64ビット）</li>
<li>GUI で立ち上げたときの必要な設定は予めやっといてほしい（Guest Additions）</li>
<li>余計なアプリケーションが入ってない最小構成（Minimal）</li>
<li>あとでアプリケーションのインストールとかも自動化したい（Chef or Puppet）</li>
</ul>

<p>と考えると、これが一番適してそうに思えます。</p>

<p><img src="/img/2013/05/vagrant04.png" alt="" /></p>

<p>わざわざコピーボタンがついているのは、<code>vagrant box add</code> の url のところにコピペするためです。</p>

<pre><code>$ vagrant box add CentOS_6.4_x86_64_Minimal http://developer.nrel.gov/downloads/vagrant-boxes/CentOS-6.4-x86_64-v20130309.box
Downloading or copying the box...
Progress: 9% (Rate: 3033k/s, Estimated time remaining: 0:02:47))
</code></pre>

<p>こんな感じで、名前をつけてやりつつ、さっきのURLを指定してボックスを作成し始めると、まずはダウンロードが開始されます。</p>

<p>ちなみに、名前のところに無駄に半角スペースが入っていると、どこが name でどこが url なのかが分からなくなるので、<strong>バックスラッシュで半角スペースの手前をエスケープするとか、そもそも半角スペースやめるとか</strong>しましょう。</p>

<p>ボックスファイルが羅列してあったさっきのページを見てみると分かるように、ボックスファイルはほぼディスクイメージなので重いです。 まったりコーヒーでも飲みながら気長に待ちましょう。</p>

<h3 id="ボックスファイルが用意出来たかどうかの確認">ボックスファイルが用意出来たかどうかの確認</h3>

<p><code>vagrant box -h</code> で help を見てみます。</p>

<pre><code>$ vagrant box -h
Usage: vagrant box &lt;command&gt; [&lt;args&gt;]

Available subcommands:
     add
     list
     remove
     repackage

For help on any individual command run `vagrant box COMMAND -h`
</code></pre>

<p><code>list</code> というサブコマンドがあるので、<code>vagrant box list</code> と入力してみます。</p>

<pre><code>$ vagrant box list
CentOS_6.4_x86_64_Minimal (virtualbox)
</code></pre>

<p>おーー、出来ておりますね。これでボックスは用意できました。</p>

<h3 id="ちなみにボックスを削除するときは">ちなみにボックスを削除するときは</h3>

<pre><code>$ vagrant box remove -h
Usage: vagrant box remove &lt;name&gt; &lt;provider&gt;
    -h, --help                       Print this help
</code></pre>

<p>サブコマンドとして remove がありますね。name, provider（仮想マシンが動くソフトウェア、ここでは virtualbox）を指定してやればいいようです。</p>

<pre><code>$ vagrant box remove CentOS 6.4 x86_64 Minimal virtualbox
Removing box 'CentOS 6.4 x86_64 Minimal' with provider 'virtualbox'...
</code></pre>

<p>試しに半角スペースありの名前で作ったボックスファイルを消しました。</p>

<h3 id="ボックスファイルはいずこへ">ボックスファイルはいずこへ？</h3>

<p>実は、この時点でもうホームディレクトリに .vagrant.d というディレクトリが出来ていて、 その下の boxes ディレクトリにボックスファイルが格納されています。</p>

<pre><code>$ cd ~/.vagrant.d/boxes/
</code></pre>

<p>この下にある virtualbox ディレクトリの中に、実体である box-disk1.vmdk というファイルが用意されているので、 仮想マシンのインストールは、これらを元に行うことになります。</p>

<p><strong>ちなみに、まだボックスファイルを用意しただけなので、仮想マシンは何にも出来てません。</strong> これも僕が初期に勘違いしてたところで、今はまだインストールディスクを用意しただけにすぎないのですね。</p>

<h2 id="仮想マシンのインストール">仮想マシンのインストール</h2>

<p>仮想マシンを作る前に、仮想マシンの置き場所へ移動してからインストール作業を始めた方が良さげです。</p>

<p>さっきのはボックスファイルなので、自動的に .vagrant.d 以下へ格納されますが、仮想マシンは別の場所へ作る必要があります。</p>

<pre><code>$ mkdir ~/Vagrant
$ cd ~/Vagrant
</code></pre>

<p>僕は ホームディレクトリに Vagrant というディレクトリを区切って、そちらで作業することにします。</p>

<h3 id="仮想マシンの設定ファイルを準備する-vagrantfile">仮想マシンの設定ファイルを準備する（Vagrantfile）</h3>

<p>さてさて、早速 help を漁りましょう。</p>

<pre><code>$ vagrant -h
Usage: vagrant [-v] [-h] command [&lt;args&gt;]

    -v, --version                    Print the version and exit.
    -h, --help                       Print this help.

Available subcommands:
     box
     destroy
     halt
     init
     package
     plugin
     provision
     reload
     resume
     ssh
     ssh-config
     status
     suspend
     up

For help on any individual command run `vagrant COMMAND -h`
</code></pre>

<p><code>init</code> というサブコマンドがあります。これを使ってボックスファイルから仮想マシンをインストールしてみます。まずは help から。</p>

<pre><code>$ vagrant init -h
Usage: vagrant init [box-name] [box-url]
    -h, --help                       Print this help
</code></pre>

<p>box-name は、オプションになっていますが、先ほどのボックスファイル名を指定します。</p>

<pre><code>$ vagrant init CentOS_6.4_x86_64_Minimal
A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.
$ ls
Vagrantfile
</code></pre>

<p><code>vagrant init [box-name]</code> を実行すると、同一ディレクトリ内に Vagrantfile なるものが生成されます。 早速これを覗いてみましょう。</p>

<pre><code># -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure(&quot;2&quot;) do |config|
  # All Vagrant configuration is done here. The most common configuration
  # options are documented and commented below. For a complete reference,
  # please see the online documentation at vagrantup.com.

  # Every Vagrant virtual environment requires a box to build off of.
  config.vm.box = &quot;CentOS_6.4_x86_64_Minimal&quot;

  # The url from where the 'config.vm.box' box will be fetched if it
  # doesn't already exist on the user's system.
  # config.vm.box_url = &quot;http://domain.com/path/to/above.box&quot;

  # Create a forwarded port mapping which allows access to a specific port
  # within the machine from a port on the host machine. In the example below,
  # accessing &quot;localhost:8080&quot; will access port 80 on the guest machine.
  # config.vm.network :forwarded_port, guest: 80, host: 8080

  # Create a private network, which allows host-only access to the machine
  # using a specific IP.
  # config.vm.network :private_network, ip: &quot;192.168.33.10&quot;

  # Create a public network, which generally matched to bridged network.
  # Bridged networks make the machine appear as another physical device on
  # your network.
  # config.vm.network :public_network
</code></pre>

<p>以下ずらずらとコメント行が続きますが、まずは config.vm.box のところに指定したボックスファイル名が 入っていることが確認できます。</p>

<p>また、コメントから3種類のネットワーク設定が可能であることが分かります。</p>

<ol>
<li>ポートフォワーディング（ゲストOSの特定ポートを、ゲストOSの別ポートにつなぐ）</li>
<li>プライベートネットワーク</li>
<li>パブリックネットワーク（ブリッジ接続）</li>
</ol>

<p>このあたりの設定は、仮想環境を作る際に検討すべき、ホストOS（今いじってるOS）とゲストOS（今作ろうとしてるOS）とをどのように接続するかの話になってきます。</p>

<p>コメント状態のまま仮想マシンを立ち上げると、NAT接続で繋がると思うので、この辺は最初はいじらないでおきます。 NAT接続は、ざっくり言うとゲストOSからの通信が、外から見るとあたかもホストOSが通信しているかのように見えます。</p>

<p>それ以外にも、コメントにいろいろ「こんな設定できるよー」と書いてあるので、読みながら試してみるのも良いのではないでしょうか。 VirtualBox の GUI から設定出来ることは、この設定ファイルから設定できるはずです。</p>

<h2 id="vagrant-up-で仮想マシンの電源オン">Vagrant up で仮想マシンの電源オン</h2>

<p><code>vagrant up -h</code> で help を読んでみます。</p>

<pre><code>$ vagrant up -h
Usage:vagrant up [vm-name] [options] [-h]

        --[no-]provision             Enable or disable provisioning
        --provision-with x,y,z       Enable only certain provisioners, by type.
        --[no-]parallel              Enable or disable parallelism if provider supports it.
        --provider provider          Back the machine with a specific provider.
    -h, --help                       Print this help
</code></pre>

<p>vm-name がオプションになっていますが、一旦仮想マシンは1つだけにしておくので、 複数作って名前を指定するのはまたの機会にしておきます。</p>

<p>ということで、オプションなしで実行します。</p>

<pre><code>$ vagrant up
Bringing machine 'default' up with 'virtualbox' provider...
[default] Importing base box 'CentOS_6.4_x86_64_Minimal'...
[default] Matching MAC address for NAT networking...
[default] Setting the name of the VM...
[default] Clearing any previously set forwarded ports...
[default] Fixed port collision for 22 =&gt; 2222. Now on port 2201.
[default] Creating shared folders metadata...
[default] Clearing any previously set network interfaces...
[default] Preparing network interfaces based on configuration...
[default] Forwarding ports...
[default] -- 22 =&gt; 2201 (adapter 1)
[default] Booting VM...
[default] Waiting for VM to boot. This can take a few minutes.
[default] VM booted and ready for use!
[default] Configuring and enabling network interfaces...
[default] Mounting shared folders...
[default] -- /vagrant
</code></pre>

<p>実行するとすぐに、<strong>「マシン名は &#8216;default&#8217; にしておいてやったぜ」</strong>という表記が出ます。 Vagrantfile に設定がなかったので &#8216;default&#8217; という仮想マシンを作ろうとしています。</p>

<p>また、ネットワークの設定も特にしていないので、<strong>「ネットワークは &#8216;NAT接続&#8217; にしておいてやったぜ」</strong>という表記が出ます。</p>

<p>さらに、<strong>「ssh の 22番ポートが衝突しちゃうから 2201 で接続できるようにしておいてやったぜ」</strong>という表記も出ています。</p>

<p><strong>・・・けっこう色々初期設定で便利な感じにやってくれてますね。</strong></p>

<p>ついでに /vagrant という共有ディレクトリも用意してくれているようです。</p>

<h3 id="もう立ち上がってるの">もう立ち上がってるの？？？</h3>

<p>実はもう電源オンの状態になっています。コマンドラインなので実感が湧かないかもしれません。</p>

<p>そういうときは、立ち上がっているかどうかを確認する <code>status</code> というサブコマンドを使ってみます。</p>

<pre><code>$ vagrant status
Current machine states:

default                  running (virtualbox)

The VM is running. To stop this VM, you can run `vagrant halt` to
shut it down forcefully, or you can run `vagrant suspend` to simply
suspend the virtual machine. In either case, to restart it again,
simply run `vagrant up`.
</code></pre>

<p>&#8216;default&#8217; という仮想マシン（さっき作りました）が、 &#8216;running&#8217; つまり動いていると。</p>

<p>ついでに止めたいときは &#8216;vagrant halt&#8217; と打てばいいよ、と教えてくれています。</p>

<p>まだまだこれだけだと、普通に1台インストールしただけなので良さは体感できないかもしれませんが、 これが<strong>複数台になった場合</strong>や、<strong>ちょっとだけ設定変えて別々にインストール</strong>、みたいな状況だと、 この設定ファイルの利点が出てくるのではないかなーと思います。</p>

<p>とにかくこれでもうインストール完了してます。便利だなー。</p>

<h2 id="インストール後の設定など">インストール後の設定など</h2>

<p>動いているとはいえ、とりあえず接続してログインまではやりたいですよね。</p>

<p>さて、再び help 漁りをしてみます。</p>

<pre><code>$ vagrant -h
Usage: vagrant [-v] [-h] command [&lt;args&gt;]

    -v, --version                    Print the version and exit.
    -h, --help                       Print this help.

Available subcommands:
     box
     destroy
     halt
     init
     package
     plugin
     provision
     reload
     resume
     ssh
     ssh-config
     status
     suspend
     up
</code></pre>

<p>この中に、<code>ssh</code> と <code>ssh-config</code> があります。 ssh でつなぐためには、<code>vagrant ssh-config</code> で表示された内容を、ホームディレクトリにある <strong>~/.ssh/config</strong> に入れてやればOKです。</p>

<pre><code>$ vagrant ssh-config
Host default
  HostName 127.0.0.1
  User vagrant
  Port 2201
  UserKnownHostsFile /dev/null
  StrictHostKeyChecking no
  PasswordAuthentication no
  IdentityFile &quot;/Users/[your-name]/.vagrant.d/insecure_private_key&quot;
  IdentitiesOnly yes
  LogLevel FATAL
</code></pre>

<p>※~/.ssh/config は、複数のSSHの設定を管理するテキストファイルで、各接続先の接続方法やら、鍵ファイルの場所やらを記述しておくことで、接続時にパスワードなど打たずに接続が可能と成ります。（詳しくはグーグル先生にでも・・・）</p>

<p>接続設定を <strong>~/.ssh/config</strong> に追加したら、そのまま <code>vagrant ssh</code> を実行してみます。</p>

<pre><code>$ vagrant ssh
Welcome to your Vagrant-built virtual machine.
[vagrant@localhost ~]$
</code></pre>

<p>おお〜〜、接続できました。どうやら初期設定で <strong>vagrant</strong> というユーザーを作っているようです。 本当に作った仮想マシンに接続できているか、いくつかコマンド打って確認してみます。</p>

<pre><code>$ uname -a
Linux localhost.localdomain 2.6.32-358.el6.x86_64 #1 SMP Fri Feb 22 00:31:26 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux
$ cat /etc/redhat-release
CentOS release 6.4 (Final)
</code></pre>

<p>うん、間違いなく作った仮想マシンに接続出来ています。</p>

<h2 id="まとめ">まとめ</h2>

<p>とりあえず仮想マシンのインストール、接続確認までですが、思った以上にめんどくさいところが初期設定として用意されていて、 正直ちょっとわくわくしました。</p>

<p>たぶんコマンドラインで仮想マシンを構築する真価が発揮されるのは、もうちょっとやった先になるとは思いますが、とりあえず1台インストール出来たので、今回はここまでにしたいと思います。</p>

<p>続き: <a href="/archives/1003/">Vagrant に仮想マシンのスナップショットがとれる sahara というプラグインを入れた</a></p>

<h2 id="ref">参考URL</h2>

<ul>
<li><a href="https://www.virtualbox.org/" target="_blank">VirtualBox</a></li>
<li><a href="http://www.vagrantup.com/" target="_blank">Vagrant</a></li>
<li><a href="http://docs.vagrantup.com/v2" target="_blank">Vagrant Documentation</a></li>
<li><a href="http://d.hatena.ne.jp/naoya/20130205/1360062070" target="_blank">Vagrant &#8211; naoyaのはてなダイアリー</a></li>
<li><a href="http://www.ryuzee.com/contents/blog/4292" target="_blank">Vagrantで簡単仮想マシン構築 | Ryuzee.com</a></li>
<li><a href="http://www.vagrantbox.es/" target="_blank">Vagrantbox.es</a></li>
</ul>


<ul class="socialbuttons">
  <li class="flow">
    <a href="https://twitter.com/share" class="twitter-share-button" data-lang="ja" data-count="vertical">Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </li>
  <li class="flow">
    <div class="fb-like" data-layout="button" data-action="like" data-size="small" data-show-faces="false" data-share="false"></div>
  </li>
  <li class="flow">
    <a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="en" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  </li>
</ul>

<div class="poststatus">
  <p>  <time datetime="2013年5月5日">2013年5月5日</time>
</p>

  <ul class="tags">
    <li class="flow"><a href="/tags/vagrant/">Vagrant</a></li>
    <li class="flow"><a href="/tags/virtualbox/">VirtualBox</a></li>
    <li class="flow"><a href="/tags/virtualization/">virtualization</a></li>
  </ul>
</div>

<small>もし記事内に誤りなどございましたら、 <a href="https://twitter.com/girigiribauer" target="_blank">@girigiribauer</a> までご一報いただけると助かります。</small>







</div>

<footer>

<h2>Tags</h2>

<ul class="tags">
  <li class="flow">
    <a href="/tags/ansible">Ansible (5)</a>
  </li>
  <li class="flow">
    <a href="/tags/apache">Apache (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/cli">CLI (10)</a>
  </li>
  <li class="flow">
    <a href="/tags/css">CSS (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/css3">CSS3 (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/cssfilter">CSSfilter (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/canvas">Canvas (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/chef">Chef (9)</a>
  </li>
  <li class="flow">
    <a href="/tags/crawler">Crawler (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/dom">DOM (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/docker">Docker (5)</a>
  </li>
  <li class="flow">
    <a href="/tags/ftp">FTP (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/font">Font (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/functionallanguage">FunctionalLanguage (2)</a>
  </li>
  <li class="flow">
    <a href="/tags/glsl">GLSL (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/git">Git (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/golang">Golang (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/html">HTML (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/html5">HTML5 (7)</a>
  </li>
  <li class="flow">
    <a href="/tags/html5-outline">HTML5-outline (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/homebrew">Homebrew (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/hugo">Hugo (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/icon-font">Icon-Font (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/javascript">JavaScript (5)</a>
  </li>
  <li class="flow">
    <a href="/tags/linux">Linux (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/mvc">MVC (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/opengraph">OpenGraph (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/php">PHP (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/rdfa">RDFa (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/ssh">SSH (4)</a>
  </li>
  <li class="flow">
    <a href="/tags/svg">SVG (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/scala">Scala (2)</a>
  </li>
  <li class="flow">
    <a href="/tags/shellscript">ShellScript (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/smartphone">Smartphone (2)</a>
  </li>
  <li class="flow">
    <a href="/tags/static-site-generator">Static Site Generator (2)</a>
  </li>
  <li class="flow">
    <a href="/tags/vagrant">Vagrant (15)</a>
  </li>
  <li class="flow">
    <a href="/tags/vim">Vim (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/virtualbox">VirtualBox (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/virtualization">Virtualization (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/webapp">WebApp (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/webaudioapi">WebAudioAPI (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/webfont">WebFont (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/webgl">WebGL (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/webrtc">WebRTC (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/webserver">WebServer (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/yeoman">Yeoman (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/zsh">Zsh (2)</a>
  </li>
  <li class="flow">
    <a href="/tags/ajax">ajax (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/automation">automation (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/bugs">bugs (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/event-conference">event-conference (5)</a>
  </li>
  <li class="flow">
    <a href="/tags/getusermedia">getUserMedia (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/gitconfig">gitconfig (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/ios">iOS (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/iterm">iTerm (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/jquery">jQuery (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/jinja2">jinja2 (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/jq">jq (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/jsperf">jsperf (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/mediaquery">mediaQuery (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/namespace">namespace (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/oldie">oldIE (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/output">output (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/polyfills">polyfills (4)</a>
  </li>
  <li class="flow">
    <a href="/tags/preloader">preloader (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/rsync">rsync (1)</a>
  </li>
  <li class="flow">
    <a href="/tags/tmux">tmux (3)</a>
  </li>
  <li class="flow">
    <a href="/tags/viewport">viewport (2)</a>
  </li>
  <li class="flow">
    <a href="/tags/vimrc">vimrc (2)</a>
  </li>
  <li class="flow">
    <a href="/tags/virtualization">virtualization (6)</a>
  </li>
  <li class="flow">
    <a href="/tags/wget">wget (1)</a>
  </li>
</ul>

<h2>Categories</h2>

<ul>
  <li>
    <a href="/categories/tech/">Category / Tech</a>
  </li>
  <li>
    <a href="/categories/twentyfour/">Category / TwentyFour</a>
  </li>
</ul>

<h2>RSS</h2>

<ul>
  <li>
    <a href="/categories/tech/index.xml" target="_blank">RSS: Category / Tech</a>
  </li>
  <li>
    <a href="/index.xml" target="_blank">RSS: All articles</a>
  </li>
</ul>

<p>このブログは個人の見解であり、所属する組織の公式見解ではありません</p>
<p>&copy; ばうあーろぐ Generated by <a href="https://gohugo.io/" target="_blank">Hugo</a> and <a href="https://github.com/sindresorhus/github-markdown-css" target="_blank">github-markdown-css</a></p>

</footer>

</div>


<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-36767095-1']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>



  </body>
</html>


